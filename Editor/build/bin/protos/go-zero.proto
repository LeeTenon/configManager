syntax = "proto3";

package config;

message ServerApiServerConf {
  ServerConf __ServerConf = 1;
  string Host = 2;
  int64 Port = 3;
  string CertFile = 4;
  string KeyFile = 5;
  bool Verbose = 6;
  int64 MaxConns = 7;
  int64 MaxBytes = 8;
  int64 Timeout = 9;
  int64 CpuThreshold = 10;
}

message ServerRpcServerConf {
  ServerConf __ServerConf = 1;
  string ListenOn = 2;
  Etcd Etcd = 3;
  bool Auth = 4;
  bool StrictControl = 5;
  int64 Timeout = 6;
  int64 CpuThreshold = 7;
}

message ServerConf {
  ServerLogConf Log = 1;
  ServerPrometheusConf Prometheus = 2;
  string MetricsUrl = 3;
  ServerMode Mode = 4;
}

message ServerLogConf {
  string ServiceName = 1;
  LogMode Mode = 2;
  string TimeFormat = 3;
  string Path = 4;
  LogLevel Level = 5;
  bool Compress = 6;
  int64 KeepDays = 7;
  int64 StackCooldownMillis = 8;
}

message ServerPrometheusConf {
  string Host = 1;
  int64 Port = 2;
  string Path = 3;
}

message Etcd {
  repeated string Host = 1;
  string key = 2;
}

message EtcdNoKey { repeated string Host = 1; }

enum LogMode {
  console = 0;
  file = 1;
  volume = 2;
}

enum ServerMode {
  pro = 0;
  dev = 1;
  test = 2;
  pre = 3;
}

enum LogLevel {
  info = 0;
  error = 1;
  severe = 2;
}